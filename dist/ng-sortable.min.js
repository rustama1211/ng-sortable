!function(){"use strict";angular.module("as.sortable",[]).constant("sortableConfig",{itemClass:"as-sortable-item",handleClass:"as-sortable-item-handle",placeHolderClass:"as-sortable-placeholder",dragClass:"as-sortable-drag",hiddenClass:"as-sortable-hidden",dragging:"as-sortable-dragging"})}(),function(){"use strict";angular.module("as.sortable").factory("$helper",["$document","$window",function(a,b){return{height:function(a){return a[0].getBoundingClientRect().height},width:function(a){return a[0].getBoundingClientRect().width},offset:function(c,d){var e=c[0].getBoundingClientRect();return d||(d=a[0].documentElement),{width:e.width||c.prop("offsetWidth"),height:e.height||c.prop("offsetHeight"),top:e.top+(b.pageYOffset||d.scrollTop-d.offsetTop),left:e.left+(b.pageXOffset||d.scrollLeft-d.offsetLeft)}},eventObj:function(a){var b=a;return void 0!==a.targetTouches?b=a.targetTouches.item(0):void 0!==a.originalEvent&&void 0!==a.originalEvent.targetTouches&&(b=a.originalEvent.targetTouches.item(0)),b},isTouchInvalid:function(a){var b=!1;return void 0!==a.touches&&a.touches.length>1?b=!0:void 0!==a.originalEvent&&void 0!==a.originalEvent.touches&&a.originalEvent.touches.length>1&&(b=!0),b},positionStarted:function(a,b,c){var d={};return d.offsetX=a.pageX-this.offset(b,c).left,d.offsetY=a.pageY-this.offset(b,c).top,d.startX=d.lastX=a.pageX,d.startY=d.lastY=a.pageY,d.nowX=d.nowY=d.distX=d.distY=d.dirAx=0,d.dirX=d.dirY=d.lastDirX=d.lastDirY=d.distAxX=d.distAxY=0,d},calculatePosition:function(a,b){a.lastX=a.nowX,a.lastY=a.nowY,a.nowX=b.pageX,a.nowY=b.pageY,a.distX=a.nowX-a.lastX,a.distY=a.nowY-a.lastY,a.lastDirX=a.dirX,a.lastDirY=a.dirY,a.dirX=0===a.distX?0:a.distX>0?1:-1,a.dirY=0===a.distY?0:a.distY>0?1:-1;var c=Math.abs(a.distX)>Math.abs(a.distY)?1:0;a.dirAx!==c?(a.distAxX=0,a.distAxY=0):(a.distAxX+=Math.abs(a.distX),0!==a.dirX&&a.dirX!==a.lastDirX&&(a.distAxX=0),a.distAxY+=Math.abs(a.distY),0!==a.dirY&&a.dirY!==a.lastDirY&&(a.distAxY=0)),a.dirAx=c},movePosition:function(a,b,c,d,e,f){var g,h="relative"===e;b.x=a.pageX-c.offsetX,b.y=a.pageY-c.offsetY,d&&(g=this.offset(d,f),h&&(b.x-=g.left,b.y-=g.top,g.left=0,g.top=0),b.x<g.left?b.x=g.left:b.x>=g.width+g.left-this.offset(b).width&&(b.x=g.width+g.left-this.offset(b).width),b.y<g.top?b.y=g.top:b.y>=g.height+g.top-this.offset(b).height&&(b.y=g.height+g.top-this.offset(b).height)),b.css({left:b.x+"px",top:b.y+"px"}),this.calculatePosition(c,a)},dragItem:function(a){return{startIndex:a.index(),startParent:a.sortableScope,index:a.index(),parent:a.sortableScope,source:a,targetElement:null,targetElementOffset:null,sourceInfo:{index:a.index(),itemScope:a.itemScope,sortableScope:a.sortableScope},canMove:function(a,b,c){return this.targetElement!==b?(this.targetElement=b,this.targetElementOffset=c,!0):(a.dirX*(c.left-this.targetElementOffset.left)>0||a.dirY*(c.top-this.targetElementOffset.top)>0)&&(this.targetElementOffset=c,!0)},rollbackPosition:function(){this.parent=this.startParent,this.index=this.startIndex},moveTo:function(a,b){this.parent=a,this.isSameParent()&&this.source.index()<b&&!this.sourceInfo.sortableScope.cloning&&(b-=1),this.index=b},isSameParent:function(){return this.parent.element===this.sourceInfo.sortableScope.element},isOrderChanged:function(){return this.index!==this.sourceInfo.index},eventArgs:function(){return{source:this.sourceInfo,dest:{index:this.index,sortableScope:this.parent}}},apply:function(){this.sourceInfo.sortableScope.cloning?this.parent.options.clone||this.parent.insertItem(this.index,angular.copy(this.source.modelValue)):(this.sourceInfo.sortableScope.removeItem(this.sourceInfo.index),(this.parent.options.allowDuplicates||this.parent.modelValue.indexOf(this.source.modelValue)<0)&&this.parent.insertItem(this.index,this.source.modelValue))}}},noDrag:function(a){return void 0!==a.attr("no-drag")||void 0!==a.attr("data-no-drag")},findAncestor:function(a,b){a=a[0];for(var c=Element.matches||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector;(a=a.parentElement)&&!c.call(a,b););return a?angular.element(a):angular.element(document.body)}}}])}(),function(){"use strict";var a=angular.module("as.sortable");a.controller("as.sortable.sortableController",["$scope",function(a){this.scope=a,a.modelValue=null,a.callbacks=null,a.type="sortable",a.options={longTouch:!1},a.isDisabled=!1,a.insertItem=function(b,c){a.options.allowDuplicates?a.modelValue.splice(b,0,angular.copy(c)):a.modelValue.splice(b,0,c)},a.removeItem=function(b){var c=null;return b>-1&&(c=a.modelValue.splice(b,1)[0]),c},a.isEmpty=function(){return a.modelValue&&0===a.modelValue.length},a.accept=function(b,c,d){return a.callbacks.accept(b,c,d)}}]),a.directive("asSortable",function(){return{require:"ngModel",restrict:"A",scope:!0,controller:"as.sortable.sortableController",link:function(a,b,c,d){var e,f;(e=d)&&(e.$render=function(){a.modelValue=e.$modelValue},a.element=b,b.data("_scope",a),f={accept:null,orderChanged:null,itemMoved:null,dragStart:null,dragMove:null,dragCancel:null,dragEnd:null},f.accept=function(a,b,c){return!0},f.orderChanged=function(a){},f.itemMoved=function(a){},f.dragStart=function(a){},f.dragMove=angular.noop,f.dragCancel=function(a){},f.dragEnd=function(a){},a.$watch(c.asSortable,function(b,c){angular.forEach(b,function(b,c){f[c]?"function"==typeof b&&(f[c]=b):a.options[c]=b}),a.callbacks=f},!0),angular.isDefined(c.isDisabled)&&a.$watch(c.isDisabled,function(b,c){angular.isUndefined(b)||(a.isDisabled=b)},!0))}}})}(),function(){"use strict";function b(a,c){return!(!c||"HTML"===c.nodeName)&&(c.parentNode===a||b(a,c.parentNode))}var a=angular.module("as.sortable");a.controller("as.sortable.sortableItemHandleController",["$scope",function(a){this.scope=a,a.itemScope=null,a.type="handle"}]),a.directive("asSortableItemHandle",["sortableConfig","$helper","$window","$document","$timeout",function(a,c,d,e,f){return{require:"^asSortableItem",scope:!0,restrict:"A",controller:"as.sortable.sortableItemHandleController",link:function(g,h,i,j){function O(a,b){"table-row"!==l.css("display")&&l.css("display","block"),b.sortableScope.options.clone||(a[0].parentNode.insertBefore(l[0],a[0]),o.moveTo(b.sortableScope,b.index()))}function P(a,b){"table-row"!==l.css("display")&&l.css("display","block"),b.sortableScope.options.clone||(a.after(l),o.moveTo(b.sortableScope,b.index()+1))}function Q(a){for(var b;!b&&a.length;)(b=a.data("_scope"))||(a=a.parent());return b}function R(){g.itemScope.sortableScope.cloning||m.replaceWith(g.itemScope.element),l.remove(),k.remove(),k=null,I=!1,p.css("cursor",""),p.removeClass("as-sortable-un-selectable")}var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,M,L=!1,N=!1;D="ontouchstart"in d,E=/iPad|iPhone|iPod/.test(d.navigator.userAgent)&&!d.MSStream,a.handleClass&&h.addClass(a.handleClass),g.itemScope=j.scope,h.data("_scope",g),g.$watchGroup(["sortableScope.isDisabled","sortableScope.options.longTouch"],function(a){L!==a[0]?(L=a[0],L?A():z()):N!==a[1]?(N=a[1],A(),z()):z()}),g.$on("$destroy",function(){angular.element(e[0].body).unbind("keydown",M)}),J=function(a){return"function"==typeof g.sortableScope.options.placeholder?angular.element(g.sortableScope.options.placeholder(a)):"string"==typeof g.sortableScope.options.placeholder?angular.element(g.sortableScope.options.placeholder):angular.element(e[0].createElement(a.element.prop("tagName")))},r=function(a){var d,b=function(){angular.element(e).unbind("mousemove",f),angular.element(e).unbind("touchmove",f),h.unbind("mouseup",b),h.unbind("touchend",b),h.unbind("touchcancel",b)},f=function(e){e.preventDefault();var f=c.eventObj(e);d||(d={clientX:f.clientX,clientY:f.clientY}),Math.abs(f.clientX-d.clientX)+Math.abs(f.clientY-d.clientY)>10&&(b(),t(a))};angular.element(e).bind("mousemove",f),angular.element(e).bind("touchmove",f),h.bind("mouseup",b),h.bind("touchend",b),h.bind("touchcancel",b),a.stopPropagation()},t=function(b){var d,f;(D||2!==b.button&&3!==b.which)&&(D&&c.isTouchInvalid(b)||!I&&x(b)&&(I=!0,b.preventDefault(),d=c.eventObj(b),g.sortableScope=g.sortableScope||g.itemScope.sortableScope,g.callbacks=g.callbacks||g.itemScope.callbacks,g.itemScope.sortableScope.options.clone||g.itemScope.sortableScope.options.ctrlClone&&b.ctrlKey?g.itemScope.sortableScope.cloning=!0:g.itemScope.sortableScope.cloning=!1,s=angular.element(e[0].querySelector(g.sortableScope.options.scrollableContainer)).length>0?e[0].querySelector(g.sortableScope.options.scrollableContainer):e[0].documentElement,p=g.sortableScope.options.containment?c.findAncestor(h,g.sortableScope.options.containment):angular.element(e[0].body),p.css("cursor","move"),p.css("cursor","-webkit-grabbing"),p.css("cursor","-moz-grabbing"),p.addClass("as-sortable-un-selectable"),q=g.sortableScope.options.containerPositioning||"absolute",o=c.dragItem(g),f=g.itemScope.element.prop("tagName"),k=angular.element(e[0].createElement(g.sortableScope.element.prop("tagName"))).addClass(g.sortableScope.element.attr("class")).addClass(a.dragClass),k.css("width",c.width(g.itemScope.element)+"px"),k.css("height",c.height(g.itemScope.element)+"px"),l=J(g.itemScope).addClass(a.placeHolderClass).addClass(g.sortableScope.options.additionalPlaceholderClass),l.css("width",c.width(g.itemScope.element)+"px"),l.css("height",c.height(g.itemScope.element)+"px"),m=angular.element(e[0].createElement(f)),a.hiddenClass&&m.addClass(a.hiddenClass),n=c.positionStarted(d,g.itemScope.element,s),g.itemScope.sortableScope.options.clone||g.itemScope.element.after(l),g.itemScope.sortableScope.cloning?k.append(g.itemScope.element.clone()):(g.itemScope.element.after(m),k.append(g.itemScope.element)),p.append(k),c.movePosition(d,k,n,p,q,s),g.sortableScope.$apply(function(){g.callbacks.dragStart(o.eventArgs())}),B()))},x=function(a){var b,d,e;for(b=angular.element(a.target),d=Q(b),e=d&&"handle"===d.type;e&&b[0]!==h[0];)c.noDrag(b)&&(e=!1),b=b.parent();return e},u=function(f){var h,i,j,r,t;if((!D||!c.isTouchInvalid(f))&&I&&k){if(f.preventDefault(),h=c.eventObj(f),g.callbacks.dragMove!==angular.noop&&g.sortableScope.$apply(function(){g.callbacks.dragMove(n,p,h)}),i=h.pageX-e[0].documentElement.scrollLeft,j=h.pageY-(d.pageYOffset||e[0].documentElement.scrollTop),k.addClass(a.hiddenClass),t=angular.element(e[0].elementFromPoint(i,j)),k.removeClass(a.hiddenClass),c.movePosition(h,k,n,p,q,s),k.addClass(a.dragging),!(r=Q(t))||!r.type)return g.itemScope.sortableScope.cloning||m.replaceWith(g.itemScope.element),l.remove(),void o.rollbackPosition();if("handle"===r.type&&(r=r.itemScope),"item"!==r.type&&"sortable"!==r.type)return;if("item"===r.type&&r.accept(g,r.sortableScope,r)){t=r.element;var u=g.sortableScope.options.scrollableContainerWindow?g.sortableScope.options.scrollableContainerWindow:s,v=c.offset(t,u);o.canMove(n,t,v);var w=y(r.sortableScope.element),x=c.offset(o.parent.element),z=0;w<0?O(t,r):w<=r.index()&&v.top+v.height+h.pageY<(d.pageYOffset||e[0].documentElement.scrollTop)+(d.innerHeight||e[0].documentElement.height)?P(t,r):(d.pageYOffset||e[0].documentElement.scrollTop)<v.top+v.height&&h.pageY>x.top+x.height+z||1==w&&h.pageY<c.offset(o.parent.element).top+v.height?O(t,r):(h.pageY+v.height>(d.pageYOffset||e[0].documentElement.scrollTop)+(d.innerHeight||e[0].documentElement.height)||h.pageY<x.top+x.height+z)&&P(t,r)}else"sortable"===r.type?r.accept(g,r)&&!b(r.element[0],t[0])&&(K(t)||r.options.clone||(t[0].appendChild(l[0]),o.moveTo(r,r.modelValue.length))):(l.remove(),o.rollbackPosition())}},y=function(b){var c,d;if(b.hasClass(a.placeHolderClass))return 0;for(c=b.children(),d=0;d<c.length;d+=1)if(angular.element(c[d]).hasClass(a.placeHolderClass))return d;return-1},K=function(a){return y(a)>=0},v=function(a){I&&(a.preventDefault(),k&&(R(),o.apply(),g.sortableScope.$apply(function(){o.isSameParent()?o.isOrderChanged()&&g.callbacks.orderChanged(o.eventArgs()):g.callbacks.itemMoved(o.eventArgs())}),g.sortableScope.$apply(function(){g.callbacks.dragEnd(o.eventArgs())}),o=null),C())},w=function(a){I&&(a.preventDefault(),k&&(R(),g.sortableScope.$apply(function(){g.callbacks.dragCancel(o.eventArgs())}),o=null),C())},z=function(){D&&(N?E?(h.bind("touchstart",F),h.bind("touchend",G),h.bind("touchmove",G)):h.bind("contextmenu",r):h.bind("touchstart",r)),h.bind("mousedown",r)},A=function(){h.unbind("touchstart",F),h.unbind("touchend",G),h.unbind("touchmove",G),h.unbind("contextmenu",r),h.unbind("touchstart",r),h.unbind("mousedown",r)},F=function(a){H=f(function(){r(a)},500)},G=function(){f.cancel(H)},M=function(a){27===a.keyCode&&w(a)},angular.element(e[0].body).bind("keydown",M),B=function(){angular.element(e).bind("touchmove",u),angular.element(e).bind("touchend",v),angular.element(e).bind("touchcancel",w),angular.element(e).bind("mousemove",u),angular.element(e).bind("mouseup",v)},C=function(){angular.element(e).unbind("touchend",v),angular.element(e).unbind("touchcancel",w),angular.element(e).unbind("touchmove",u),angular.element(e).unbind("mouseup",v),angular.element(e).unbind("mousemove",u)}}}}])}(),function(){"use strict";var a=angular.module("as.sortable");a.controller("as.sortable.sortableItemController",["$scope",function(a){this.scope=a,a.sortableScope=null,a.modelValue=null,a.type="item",a.index=function(){return a.$index},a.itemData=function(){return a.sortableScope.modelValue[a.$index]}}]),a.directive("asSortableItem",["sortableConfig",function(a){return{require:["^asSortable","?ngModel"],restrict:"A",controller:"as.sortable.sortableItemController",link:function(b,c,d,e){var f=e[0],g=e[1];a.itemClass&&c.addClass(a.itemClass),b.sortableScope=f.scope,g?g.$render=function(){b.modelValue=g.$modelValue}:b.modelValue=f.scope.modelValue[b.$index],b.element=c,c.data("_scope",b)}}}])}();
